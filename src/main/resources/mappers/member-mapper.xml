<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="memberMapper">

    <resultMap id="member_rm" type="Member">
        <id property="memberNo" column="MEMBER_NO"/>
        <result property="memberId" column="MEMBER_ID"/>
        <result property="memberPw" column="MEMBER_PW"/>
        <result property="memberName" column="MEMBER_NM"/>
        <result property="memberAddress" column="MEMBER_ADDR"/>
        <result property="memberFName" column="MEMBER_FN"/>
        <result property="memberPhone" column="MEMBER_PHONE"/>
        <result property="memberGender" column="MEMBER_GENDER"/>
        <result property="memberEnrollDate" column="MEMBER_ENROLL_DT"/>
        <result property="memberType" column="MEMBER_TYPE"/>
        <result property="statusCode" column="STATUS_CD"/>
    </resultMap>

    <insert id="kakaoLogin">
        INSERT INTO MEMBER VALUES(
         SEQ_MEMBER_NO.NEXTVAL, #{kakaoEmail}, NULL, NULL, NULL,
         #{kakaonickname}, NULL, #{kakaoGender}, DEFAULT, 'KAKAO', DEFAULT)
    </insert>

    <select id="emailLogin" resultMap="member_rm">
        SELECT * FROM MEMBER
        WHERE MEMBER_ID = #{memberId}
        AND STATUS_CD = 0
        AND MEMBER_TYPE = 'EMAIL'
    </select>
    
     <!-- 아이디 중복 검사 -->
	 <select id="idDupCheck"  resultType="_int" >
	 SELECT COUNT(*) FROM MEMBER
	 WHERE MEMBER_ID = #{inputId}
	 AND STATUS_CD != 1
	 </select>
	 
	 <!-- 닉네임 중복 검사 -->
	 <select id="nickNmDupCheck"  resultType="_int" >
	 SELECT COUNT(*) FROM MEMBER
	 WHERE MEMBER_FN = #{inputNickNm}
	 AND STATUS_CD != 1
	 </select>
	 
	 <!--  회원 가입 -->			
	 <insert id="signUp" parameterType="Member">
	 INSERT INTO MEMBER VALUES(
	 	SEQ_MEMBER_NO.NEXTVAL, #{memberId}, #{memberPw}, #{memberName},
	 	#{memberAddress}, #{memberFName}, #{memberPhone}, #{memberGender}, DEFAULT, DEFAULT)
	 </insert>

</mapper>
